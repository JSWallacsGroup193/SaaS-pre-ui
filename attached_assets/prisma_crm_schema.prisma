
// 1. Customer
model Customer {
  id             String    @id @default(uuid())
  fullName       String
  email          String
  phone          String
  preferredContactMethod String
  preferences    CustomerPreference?
  properties     Property[]
  performance    CustomerPerformance?
  createdAt      DateTime  @default(now())
  updatedAt      DateTime  @updatedAt
}

// 2. Customer Preferences
model CustomerPreference {
  id                       String   @id @default(uuid())
  customerId               String   @unique
  preferredServiceTime     String
  techRequest              String?
  petNoticeRequired        Boolean
  parkingInstructions      String?
  gateAccessCode           String?
  shoesOffRequired         Boolean
  airQualitySensitivity    String?
  communicationNotes       String?
  customer                 Customer @relation(fields: [customerId], references: [id])
}

// 3. Property
model Property {
  id           String      @id @default(uuid())
  customerId   String
  address      String
  propertyType String
  squareFootage Int
  hvacUnits    Int
  accessNotes  String?
  customer     Customer    @relation(fields: [customerId], references: [id])
  equipment    Equipment[]
}

// 4. Equipment
model Equipment {
  id              String     @id @default(uuid())
  propertyId      String
  systemType      String
  brand           String
  model           String
  serialNumber    String
  installDate     DateTime?
  location        String
  photoUrl        String?
  maintenanceHistory String?
  warrantyStatus  String?
  property        Property   @relation(fields: [propertyId], references: [id])
  serviceRequests ServiceRequest[]
}

// 5. Service Request
model ServiceRequest {
  id                 String     @id @default(uuid())
  customerId         String
  equipmentId        String
  requestType        String
  problemDescription String
  preferredDateTime  DateTime
  technicianNotes    String?
  status             String
  customer           Customer   @relation(fields: [customerId], references: [id])
  equipment          Equipment  @relation(fields: [equipmentId], references: [id])
  financial          Financial?
}

// 6. Financials
model Financial {
  id               String     @id @default(uuid())
  serviceRequestId String     @unique
  estimateAmount   Float
  invoiceTotal     Float
  paymentStatus    String
  paymentMethod    String
  serviceRequest   ServiceRequest @relation(fields: [serviceRequestId], references: [id])
}

// 7. Customer Performance
model CustomerPerformance {
  id                      String   @id @default(uuid())
  customerId              String   @unique
  totalJobsCompleted      Int
  averageTicketValue      Float
  serviceCallFrequency    Int
  lastServiceDate         DateTime?
  averagePaymentTime      Int
  latePayments            Int
  activePaymentPlan       Boolean
  totalRevenueYTD         Float
  totalCostToServe        Float
  grossMarginPercent      Float
  discountsGiven          Boolean
  maintenancePlanEnrolled Boolean
  respondsToUpsell        Boolean
  reviewLeft              Boolean
  referralsCount          Int
  cancellationRate        Float
  disputesCount           Int
  specialHandlingRequired Boolean
  customer                Customer @relation(fields: [customerId], references: [id])
}
